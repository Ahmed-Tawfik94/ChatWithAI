<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="AI Project Manager">
    <meta name="theme-color" content="#2b1a4d"/>
    <meta name="description" content="this PWA is designed to help newly users to understand about project management">
    <link rel="apple-touch-icon" href="/static/icon.png">

    <link
      href="{{url_for('static',filename='/css/bootstrap.min.css')}}"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastr@2.1.4/build/toastr.min.css">
    
    <script
    src="https://kit.fontawesome.com/52d77073d0.js"
    crossorigin="anonymous"
    ></script>
    <style>
      html,body{
        width: 100%;
        height: 100vh;
        margin: 0;
        padding: 0;
      }
      #refresh-indicator {
        text-align: center;
        padding: 10px;
        background-color: #f0f0f0;
        display: none;
      }
    </style>
    <title>Chat with AI</title>
    {% block style %}{% endblock %}
  </head>
  <body>
    <div id="refresh-indicator">Pull to refresh</div>
    {% block content %}{% endblock %}
    <script src="{{url_for('static',filename='/js/mustache.min.js')}}"></script>
    <script src="{{url_for('static',filename='/js/highlight.min.js')}}"></script>
    <script src="{{url_for('static',filename='/js/showdown.min.js')}}"></script>
    <script src="{{url_for('static',filename='/js/jquery.min.js')}}"></script>
    <script src="{{url_for('static',filename='/js/bootstrap.bundle.min.js')}}"></script>
    <script src="{{url_for('static',filename='/js/bootstrap.min.js')}}"></script>
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastr@2.1.4/toastr.min.js"></script>
    <script src="{{url_for('static',filename='/js/app.js')}}"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register("/sw.js").then(function(registration) {
            //console.log(registration);
            //console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, function(err) {
            toastr.error(`ServiceWorker registration failed ${err}`, 'Error');
            //console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
      const container = document.getElementsByTagName('body');
          const refreshIndicator = document.getElementById('refresh-indicator');

          let startY = 0;

          container.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
          });

          container.addEventListener('touchmove', (e) => {
            const deltaY = e.touches[0].clientY - startY;

            if (deltaY > 0 && container.scrollTop === 0) {
              e.preventDefault(); // Prevent the default scroll behavior

              // Move the refresh indicator with the touch movement
              refreshIndicator.style.transform = `translateY(${deltaY}px)`;

              // Show the refresh indicator when pulled down enough
              if (deltaY > 60) {
                refreshIndicator.textContent = 'Release to refresh';
              } else {
                refreshIndicator.textContent = 'Pull to refresh';
              }
            }
          });

          container.addEventListener('touchend', () => {
            if (container.scrollTop === 0) {
              // Reset the refresh indicator position
              refreshIndicator.style.transform = 'translateY(0)';
              refreshIndicator.textContent = 'Pull to refresh';

              // Simulate a refresh (replace with your actual refresh logic)
              setTimeout(() => {
                alert('Refreshed!');
              }, 1000);
            }
          });

    </script>
    {% block script %}{% endblock %}
  </body>
</html>
